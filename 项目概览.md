# 📁 文件管理系统 - 项目概览

## 🎯 项目介绍

这是一个基于 **Spring Boot 3 + Kotlin + Vue 3** 开发的全栈文件管理系统，支持文件的上传、下载、预览、删除等功能。项目采用前后端分离架构，后端使用现代化的技术栈，适合作为学习项目和求职作品集。

## ✨ 核心特性

### 后端功能
- ✅ 文件上传（支持多文件、拖拽上传、进度显示）
- ✅ 文件下载（支持断点续传、中文文件名）
- ✅ 文件列表（分页、搜索、排序）
- ✅ 文件删除（逻辑删除、批量删除）
- ✅ MD5秒传（相同文件自动去重）
- ✅ Redis缓存（提升查询性能）
- ✅ MinIO存储（对象存储，支持分布式）
- ✅ Swagger文档（自动生成API文档）
- ✅ 全局异常处理
- ✅ 统一响应格式

### 前端功能（待开发）
- ⬜ Vue 3 + TypeScript
- ⬜ Element Plus UI
- ⬜ 文件上传组件（拖拽、进度条）
- ⬜ 文件列表展示（表格、卡片视图）
- ⬜ 文件预览（图片、PDF、视频）
- ⬜ 响应式布局

## 🛠️ 技术栈

### 后端技术
| 技术 | 版本 | 说明 |
|------|------|------|
| Spring Boot | 3.5.6 | 核心框架 |
| Kotlin | 1.9.25 | 开发语言 |
| MyBatis-Plus | 3.5.5 | ORM框架 |
| MySQL | 8.0+ | 关系数据库 |
| Redis | 7.0+ | 缓存 |
| MinIO | 8.5.7 | 对象存储 |
| Knife4j | 4.4.0 | API文档 |
| Hutool | 5.8.24 | 工具库 |

### 前端技术（规划）
| 技术 | 版本 | 说明 |
|------|------|------|
| Vue | 3.4+ | 前端框架 |
| TypeScript | 5.0+ | 类型支持 |
| Vite | 5.0+ | 构建工具 |
| Element Plus | 2.5+ | UI组件库 |
| Axios | 1.6+ | HTTP客户端 |
| Pinia | 2.1+ | 状态管理 |

## 📂 项目结构

```
multifunctional-backend/
├── src/main/
│   ├── kotlin/com/zzy/multifunctional_backend/
│   │   ├── controller/          # 控制器层
│   │   │   └── FileController.kt
│   │   ├── service/              # 服务层
│   │   │   ├── FileService.kt
│   │   │   └── StorageService.kt
│   │   ├── entity/               # 实体类
│   │   │   └── FileMetadata.kt
│   │   ├── mapper/               # 数据访问层
│   │   │   └── FileMapper.kt
│   │   ├── dto/                  # 数据传输对象
│   │   │   ├── ApiResponse.kt
│   │   │   ├── FileResponse.kt
│   │   │   └── FileListResponse.kt
│   │   ├── config/               # 配置类
│   │   │   ├── CorsConfig.kt
│   │   │   ├── RedisConfig.kt
│   │   │   ├── MinioConfig.kt
│   │   │   └── MyBatisPlusConfig.kt
│   │   ├── exception/            # 异常处理
│   │   │   ├── GlobalExceptionHandler.kt
│   │   │   └── CustomException.kt
│   │   └── util/                 # 工具类
│   │       ├── FileUtil.kt
│   │       └── RedisUtil.kt
│   └── resources/
│       ├── application.properties  # 应用配置
│       ├── mapper/                 # MyBatis映射文件
│       │   └── FileMapper.xml
│       └── sql/                    # SQL脚本
│           └── schema.sql
├── pom.xml                        # Maven配置
├── docker-compose.yml             # Docker配置
├── 文件管理系统-技术方案.md       # 技术方案文档
├── README-Backend.md              # 后端开发文档
├── 启动指南.md                    # 启动指南
└── 项目概览.md                    # 本文档
```

## 🚀 快速开始

### 1. 克隆项目
```bash
git clone <repository-url>
cd multifunctional-backend
```

### 2. 启动依赖服务（Docker）
```bash
docker-compose up -d
```

### 3. 初始化数据库
```bash
mysql -h 127.0.0.1 -u root -proot123 < src/main/resources/sql/schema.sql
```

### 4. 启动应用
```bash
mvn spring-boot:run
```

### 5. 访问服务
- 后端API: http://localhost:8080
- API文档: http://localhost:8080/doc.html
- MinIO控制台: http://localhost:9001

详细启动说明请查看 **[启动指南.md](./启动指南.md)**

## 📊 系统架构

```
┌─────────────────────────────────────────┐
│          前端层 (Vue 3)                  │
│    文件上传 | 文件列表 | 文件预览        │
└─────────────────────────────────────────┘
                    ↕ REST API
┌─────────────────────────────────────────┐
│       后端层 (Spring Boot + Kotlin)      │
│  Controller → Service → Mapper → Entity │
└─────────────────────────────────────────┘
                    ↕
┌──────────┐  ┌──────────┐  ┌──────────┐
│  MySQL   │  │  Redis   │  │  MinIO   │
│ (元数据) │  │  (缓存)  │  │  (文件)  │
└──────────┘  └──────────┘  └──────────┘
```

## 📡 核心API

### 文件上传
```http
POST /api/files/upload
Content-Type: multipart/form-data

参数:
- file: 上传的文件
- userId: 用户ID(可选)

响应:
{
  "code": 200,
  "message": "文件上传成功",
  "data": {
    "id": 1,
    "fileName": "example.pdf",
    "fileSizeFormatted": "2.5 MB",
    "downloadUrl": "/api/files/1/download"
  }
}
```

### 获取文件列表
```http
GET /api/files?page=1&size=10&keyword=pdf

响应:
{
  "code": 200,
  "message": "查询成功",
  "data": {
    "total": 100,
    "page": 1,
    "size": 10,
    "files": [...]
  }
}
```

### 下载文件
```http
GET /api/files/{id}/download

响应: 文件流
```

### 删除文件
```http
DELETE /api/files/{id}

响应:
{
  "code": 200,
  "message": "删除成功"
}
```

完整API文档: http://localhost:8080/doc.html

## 🎨 设计特点

### 1. 分层架构
- **Controller层**: 处理HTTP请求，参数验证
- **Service层**: 业务逻辑处理
- **Mapper层**: 数据访问
- **Entity层**: 数据模型

### 2. 统一响应格式
```kotlin
data class ApiResponse<T>(
    val code: Int,
    val message: String,
    val data: T?,
    val timestamp: Long
)
```

### 3. 全局异常处理
- 业务异常
- 文件异常
- 参数异常
- 系统异常

### 4. Redis缓存策略
- 文件列表缓存: 5分钟
- 文件详情缓存: 10分钟
- 自动失效机制

### 5. 文件存储方案
- MinIO对象存储
- UUID文件名
- MD5去重秒传
- 支持扩展云存储

## 🔄 核心流程

### 文件上传流程
```
1. 前端选择文件
2. 验证文件大小和类型
3. 计算文件MD5
4. 检查是否存在(秒传)
5. 上传到MinIO
6. 保存元数据到MySQL
7. 返回文件信息
8. 清除缓存
```

### 文件下载流程
```
1. 根据ID查询文件信息
2. 从MinIO获取文件流
3. 设置响应头
4. 返回文件流
5. 增加下载次数
6. 更新缓存
```

## 📈 性能优化

### 1. 数据库优化
- 索引优化（file_name, upload_time, file_md5）
- 分页查询
- 逻辑删除

### 2. 缓存优化
- Redis缓存热点数据
- 缓存过期策略
- 缓存失效处理

### 3. 存储优化
- MinIO分布式存储
- 文件MD5去重
- 流式传输大文件

## 🔐 安全考虑

- ✅ 文件类型白名单
- ✅ 文件大小限制
- ✅ UUID文件名（防止路径遍历）
- ✅ 异常信息脱敏
- ⬜ 用户认证（JWT）
- ⬜ 权限控制（RBAC）
- ⬜ 文件访问密码
- ⬜ 病毒扫描

## 📝 开发进度

### 已完成 ✅
- [x] 项目初始化
- [x] 技术方案设计
- [x] 后端架构搭建
- [x] 文件上传功能
- [x] 文件下载功能
- [x] 文件列表查询
- [x] 文件删除功能
- [x] Redis缓存集成
- [x] MinIO存储集成
- [x] API文档生成
- [x] 异常处理机制
- [x] Docker部署配置

### 进行中 🚧
- [ ] 前端Vue 3开发
- [ ] 用户认证系统
- [ ] 权限控制

### 规划中 📋
- [ ] 文件分享功能
- [ ] 实时通知（WebSocket）
- [ ] 云存储集成（OSS）
- [ ] 数据统计分析
- [ ] 移动端适配
- [ ] 单元测试

## 🤝 贡献指南

欢迎提交Issue和Pull Request！

### 开发规范
- 遵循Kotlin编码规范
- 提交前进行代码格式化
- 编写必要的注释
- 提交信息使用中文

### 分支管理
- `main`: 主分支（稳定版本）
- `develop`: 开发分支
- `feature/*`: 功能分支
- `bugfix/*`: 修复分支

## 📚 学习资源

### 官方文档
- [Spring Boot](https://spring.io/projects/spring-boot)
- [Kotlin](https://kotlinlang.org/docs/home.html)
- [MyBatis-Plus](https://baomidou.com/)
- [Vue 3](https://cn.vuejs.org/)
- [Element Plus](https://element-plus.org/zh-CN/)

### 视频教程
- B站：尚硅谷Spring Boot教程
- B站：coderwhy Vue3 + TS教程

### 技术博客
- 掘金
- CSDN
- 思否

## 📄 许可证

MIT License

## 👨‍💻 作者

**ZZY**
- Email: your-email@example.com
- GitHub: your-github

---

**更新时间**: 2025-10-09  
**项目版本**: v1.0.0


